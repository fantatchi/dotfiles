---
name: obs-log
description: 作業履歴の記録
---

# 作業履歴の記録

今回のセッションで行った作業を振り返り、Obsidian Vaultに記録を残してください。

## 書き出し先

`$OBSIDIAN_VAULT/_ClaudeLogs/`

※ 環境変数 `OBSIDIAN_VAULT` が設定されていない場合はエラーを表示し、設定方法を案内すること。

## ファイル名

- 手動記録: `YYYY-MM-DD_HHmm_簡潔な作業概要.md`
- 自動記録: `YYYY-MM-DD_HHmm_簡潔な作業概要_auto.md`

（日本語OK、スペースはハイフンに置換）

## 引数の扱い

$ARGUMENTS が渡される。

- スペース区切りでそれぞれを tags に追加する
- 例: `/log backend auth` → tags: claude-log, backend, auth, ...
- 引数が空の場合は `claude-log` のみ＋自動生成タグ

## タグの自動生成

引数のタグに加え、作業内容から関連タグを自動生成して追加する。

- 使用した言語・フレームワーク（例: typescript, react, python）
- 作業の種類（例: bugfix, refactor, feature, docs, config）
- 対象領域（例: api, ui, db, auth, test）

ルール：
- `claude-log` は常に含める
- 引数タグ＋自動生成タグの合計が最大5個になるようにする（claude-log は数に含めない）
- 引数タグを優先し、残り枠を自動生成で埋める

## 出力フォーマット

以下のフォーマットで書き出すこと：

```
---
tags:
  - claude-log
  - （自動生成タグ・引数タグをここに追加）
date: YYYY-MM-DD
project: プロジェクト名
files_changed: 0
---

## 概要

（1-2行で何をしたか）

## 対話記録

### #1 HH:MM — やり取りの要約タイトル

> **指示**: ユーザーの指示を要約（意図が伝われば十分）

**方針**: 判断を伴う場合のみ記載。どう進めることにしたか

**対応**:
- 実施した作業を箇条書き
- `path/to/file.ts` を作成・修正した内容

**結果**: 成果の要約

**判断メモ**: 後から「なぜそうしたか」がわかる記録（あれば）

---

### #2 HH:MM — 次のやり取り

> **指示**: ...

（以下同様）

## 変更ファイル一覧

| 操作 | ファイル |
|------|----------|
| 新規 | `path/to/new-file.ts` |
| 修正 | `path/to/modified-file.ts` |

## 残課題

- [ ] （あれば。なければこのセクションごと省略）
```

### 対話記録の書き方ルール

- ユーザーの指示は `> **指示**:` で始め、ブロック引用で囲む
- 指示は正確な原文でなくてよい。意図が伝わる要約で十分
- 1つの指示とそれに対する対応を1つの `### #N` にまとめる
- 各ペアのタイトルは「何についてのやり取りか」を簡潔に
- 「方針」は判断を伴う場合のみ。単純作業では省略可
- 「判断メモ」は後から読んで理由がわかるように書く
- ペア間は水平線（---）で区切る
- 雑談や短い確認のやり取りは1つのペアにまとめてよい
- ファイルパスはバッククォートで囲む
- エラーや試行錯誤もそのまま書く

## 自動記録のルール

自動記録（CLAUDE.md のトリガー条件で呼ばれた場合）は以下に従うこと：

- タグに `auto` を常に含める
- ファイル名に `_auto` を付けて手動ログと区別する（例: `2026-02-03_1430_認証リファクタ_auto.md`）
- 書き出したら「自動ログを記録しました: （ファイル名）」とユーザーに通知する
- ユーザーの作業を中断しないこと
- 同じ内容で重複して書き出さないこと
- ユーザーが `/obs-log` を実行した直後は、次の条件を満たすまでカウントをリセットする

## 注意事項

- セッション全体を振り返ってから書くこと
- diffの羅列ではなく、人間が後から読んで文脈がわかるように書くこと
- 書き出し先ディレクトリが存在しない場合は作成すること
