# 基本方針

- 日本語で会話する
- コミットメッセージは日本語で書く
- 不明点や選択肢があれば推測で進めず、質問して埋める
- 未確認の情報は断定しない（「未確認」と明示する）

# コミュニケーションスタイル

- 質問は AskUserQuestion を使い、選択式で答えやすくする
- 1回あたり 3〜5 個、ブロッカー（答えがないと進めない質問）を優先する
- 仕様の選択肢は「複数案 + 推奨案 + トレードオフ」で提示して選んでもらう

# タスクの進め方

## 小さなタスク（明確な修正・設定変更など）

- 作業内容を簡潔に説明してから実行する

## 中規模以上のタスク

1. 依頼内容を 1〜3 行で要約し、分かっていること・未確定事項を整理する
2. 未確定事項を質問する（回答を得るまで実装に踏み込まない）
3. 回答を踏まえて、目的・スコープ・受入条件・非目標を確認する
4. 実装計画を立て、承認を得てから実行する

## 実行中のルール

- 高リスク・不可逆の操作が必要になったら停止して確認する
- 方針の分岐や想定外の結果が出たら停止して質問する
- 主要ステップごとに進捗を報告する

# やらないこと

- mainブランチへの直接push
- 確認なしの破壊的変更（rm -rf など）

# 作業ログの記録

作業ログは Obsidian Vault に記録する。

前提条件：
- `~/.claude/config.json` に `obsidian_vault` が設定されていること
- 設定されていない場合は機能を使用せず、設定方法を案内すること

ルール：
- 書き出し先・フォーマット・タグ等の詳細は `/obsidian-log` スキル（`.claude/skills/obsidian-log/SKILL.md`）に従う
- 書き出し先ディレクトリが存在しない場合は作成すること

## 手動記録

ユーザーが `/obsidian-log` を実行したときに記録する。

## 自動記録（フォールバック）

`PreCompact`（コンテキスト圧縮前）のフックがシェルスクリプト（`~/.claude/scripts/obsidian-log-hook.sh`）を直接実行し、git diff ベースの簡易ログを Obsidian Vault に記録する。
Claude を介さないため、セッション内容（対話記録・判断メモ等）は含まれず、git 由来の変更情報のみ。
手動 `/obsidian-log` の補完（忘れたとき用のフォールバック）として機能する。
未コミット変更がない場合はスキップする。

# コンテキストの保存・復帰

保存先はプロジェクトルートの `.claude/context.md`。

## 手動操作

- `/context-save` — 現在のプロジェクトコンテキストを `.claude/context.md` に保存
- `/context-load` — `.claude/context.md` からコンテキストを読み込み

## 自動保存

`SessionEnd`（セッション終了時・`/clear` 時）のフックがシェルスクリプト（`~/.claude/scripts/context-save-hook.sh`）を直接実行し、git 状態（ブランチ・コミット・未コミット変更）をプロジェクトルートの `.claude/context.md` に保存する。
Claude を介さないため `/clear` やセッション終了時にも確実に動作する。
ただしセッション知識（判断メモ・次のステップ等）は保存できないため、必要に応じて手動で `/context-save` を実行すること。
