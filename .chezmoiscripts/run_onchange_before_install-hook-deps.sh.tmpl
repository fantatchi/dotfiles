{{- if ne .chezmoi.os "linux" -}}
{{- /* Windows では実行しない（空出力でスキップ） */ -}}
{{- else -}}
#!/bin/bash
set -euo pipefail

echo "=== Claude Code hook の依存チェック (Linux) ==="

install_if_missing() {
    local cmd="$1"
    local pkg="${2:-$1}"
    if command -v "$cmd" &>/dev/null; then
        echo "  [OK] $cmd"
    else
        echo "  [INSTALL] $cmd (apt: $pkg)"
        sudo apt-get update -qq && sudo apt-get install -y -qq "$pkg"
    fi
}

install_if_missing jq

echo ""
echo "依存チェック完了"
{{ end -}}
